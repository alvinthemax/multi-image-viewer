<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Format Archive Image Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/unrar.js@0.4.1/unrar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/7z-wasm@0.10.1/7z-wasm.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #333;
            text-align: center;
        }

        h2 {
            font-size: 1.2em;
            margin-bottom: 5px;
            color: #555;
            text-align: center;
        }

        #fileInput {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #0066cc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 10px;
        }

        #fileInput:hover {
            background-color: #005bb5;
        }

        #resetBtn {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        #resetBtn:hover {
            background-color: #c0392b;
        }

        #imageContainer {
            display: flex;
            flex-wrap: wrap;
            margin-top: 20px;
            justify-content: center;
        }

        img {
            max-width: 300px;
            margin: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        img:hover {
            transform: scale(1.05);
        }

        /* Modal styling */
        #imageModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #modalContent {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #modalImage {
            max-width: 100%;
            max-height: 100%;
            display: block;
            position: relative;
            z-index: 1;
        }

        .modalNav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.5em;
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
            z-index: 2;
        }

        .modalNav:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        #prevBtn {
            left: 10px;
        }

        #nextBtn {
            right: 10px;
        }

        #closeModal {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.5em;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            z-index: 2;
        }

        #closeModal:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        /* Zoom controls */
        #zoomControls {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            z-index: 2;
        }

        #zoomIn,
        #zoomOut,
        #resetZoom {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.5em;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
            margin: 0 5px;
        }

        #zoomIn:hover,
        #zoomOut:hover,
        #resetZoom:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        /* List styling */
        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        li {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        li img {
            width: 15px; /* Set the width for the icon */
            height: 15px; /* Set the height for the icon */
            margin-right: 5px; /* Space between icon and text */
            position: relative; /* For positioning the tooltip */
            cursor: pointer; /* Pointer cursor on hover */
        }
    </style>
</head>

<body>
    <h1>Multi Images Viewer</h1>
    <h2>Step: Upload - Select - View Images</h2>
    <h2>Supported:</h2>
    <ul>
        <li>
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQGdMxF-TCSKA0icLF4Safpa9Z9ie6jK0dGWA&usqp=CAU" alt="Directory icon" />
            Directory containing images
        </li>
        <li>
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR0YKrND0bR-WXKyVZ7hPlPCJOygqW_ovVidA&usqp=CAU" alt="Image files icon" />
            General files (.jpg/.jpeg/.png)
        </li>
        <li>
            <img src="https://static-00.iconduck.com/assets.00/compressed-file-icon-2048x1582-8c25g1g0.png" alt="Compressed files icon" />
            Compressed files (.7z/.rar/.zip)
        </li>
    </ul>

    <input type="file" id="fileInput" webkitdirectory />
    <button id="resetBtn">Reset</button>
    <div id="imageContainer"></div>

    <!-- Modal -->
    <div id="imageModal">
        <div id="modalContent">
            <img id="modalImage" src="" alt="Modal Image" />
            <button id="closeModal">✖</button>
            <button id="prevBtn" class="modalNav">‹</button>
            <button id="nextBtn" class="modalNav">›</button>
            <div id="zoomControls">
                <button id="zoomOut">-</button>
                <button id="resetZoom">⟳</button>
                <button id="zoomIn">+</button>
            </div>
        </div>
    </div>

    <script>
        let currentIndex = 0;
        let zoomLevel = 1;
        let imageList = [];

        document.getElementById('fileInput').addEventListener('change', function (event) {
            const files = event.target.files;
            Array.from(files).forEach((file) => {
                const fileName = file.name.toLowerCase();

                if (fileName.endsWith('.zip')) {
                    handleZipFile(file);
                } else if (fileName.endsWith('.rar')) {
                    handleRarFile(file);
                } else if (fileName.endsWith('.7z')) {
                    handle7zFile(file);
                } else if (fileName.endsWith('.jpg') || fileName.endsWith('.jpeg') || fileName.endsWith('.png')) {
                    displayImage(file);
                }
            });
        });

        function handleZipFile(file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                JSZip.loadAsync(event.target.result).then((zip) => {
                    Object.keys(zip.files).forEach((fileName) => {
                        if (fileName.endsWith('.jpg') || fileName.endsWith('.jpeg') || fileName.endsWith('.png')) {
                            zip.files[fileName].async('blob').then(displayImage);
                        }
                    });
                });
            };
            reader.readAsArrayBuffer(file);
        }

        function handleRarFile(file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const buffer = new Uint8Array(event.target.result);
                const rar = unrarjs.Unrar.open(buffer);
                const files = rar.getFileList();
                files.forEach((file) => {
                    if (file.name.endsWith('.jpg') || file.name.endsWith('.jpeg') || file.name.endsWith('.png')) {
                        const imgBlob = rar.readFile(file.name);
                        displayImage(new Blob([imgBlob], { type: file.mime }));
                    }
                });
                rar.close();
            };
            reader.readAsArrayBuffer(file);
        }

        async function handle7zFile(file) {
            const reader = new FileReader();
            reader.onload = async (event) => {
                const buffer = new Uint8Array(event.target.result);
                const sevenZip = await SevenZip.load();
                const archive = await sevenZip.open(buffer);
                for (const file of archive.getEntries()) {
                    if (file.isDirectory) continue;
                    if (file.name.endsWith('.jpg') || file.name.endsWith('.jpeg') || file.name.endsWith('.png')) {
                        const imgBlob = await file.getData();
                        displayImage(new Blob([imgBlob], { type: file.mime }));
                    }
                }
                await archive.close();
            };
            reader.readAsArrayBuffer(file);
        }

        function displayImage(file) {
            const img = document.createElement('img');
            img.src = URL.createObjectURL(file);
            img.alt = file.name;
            img.addEventListener('click', () => openModal(img.src));
            document.getElementById('imageContainer').appendChild(img);
            imageList.push(img.src);
        }

        function openModal(src) {
            document.getElementById('imageModal').style.display = 'flex';
            document.getElementById('modalImage').src = src;
            currentIndex = imageList.indexOf(src);
            zoomLevel = 1; // Reset zoom on opening modal
            updateImageTransform();
        }

        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        function updateImageTransform() {
            const modalImage = document.getElementById('modalImage');
            modalImage.style.transform = `scale(${zoomLevel})`;
        }

        document.getElementById('closeModal').addEventListener('click', closeModal);

        document.getElementById('prevBtn').addEventListener('click', () => {
            currentIndex = (currentIndex > 0) ? currentIndex - 1 : imageList.length - 1;
            document.getElementById('modalImage').src = imageList[currentIndex];
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            currentIndex = (currentIndex < imageList.length - 1) ? currentIndex + 1 : 0;
            document.getElementById('modalImage').src = imageList[currentIndex];
        });

        document.getElementById('zoomIn').addEventListener('click', () => {
            zoomLevel += 0.1;
            updateImageTransform();
        });

        document.getElementById('zoomOut').addEventListener('click', () => {
            zoomLevel = Math.max(1, zoomLevel - 0.1);
            updateImageTransform();
        });

        document.getElementById('resetZoom').addEventListener('click', () => {
            zoomLevel = 1;
            updateImageTransform();
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            document.getElementById('imageContainer').innerHTML = '';
            imageList = [];
        });
    </script>
</body>

</html>
